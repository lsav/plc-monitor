<!-- 
  jinja2 template to display the node data in a sortable table 
  Requires:
    - headings: list of headings to be displayed
    - data: 2-D array where each row is the data for each host
-->

<!DOCTYPE html>
<html>

<title>PLC Monitor</title>
<meta charset="utf-8">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<script src="https://www.w3schools.com/lib/w3.js"></script>
<body class="w3-container">

<h2>Planetlab Node Monitor</h2>

<p>This page periodically collects the following data for all 704 PLC nodes:</p>

<ul>
  <li><strong>Alive:</strong> A node is considered alive if it is reachable by SSH.</li>
  <li><strong>Uptime:</strong> Percentage of times, in the last 24 hours, that a node was alive.</li>
  <li><strong>Latency:</strong> Time taken to establish an ssh connection, in seconds.</li>
  <li><strong>SCP Time:</strong> Time taken to transfer a small (~4KB) plain text file.</li>
  <li><strong>CPU:</strong> CPU utilization, as of last check. (currently unimplemented)</li>
  <li><strong>Memory:</strong> Memory consumption, as of last check. (currently unimplemented)</li>
</ul>

Only nodes that have been alive at some point in the last day are displayed.

<p>Last update: {{ last_update }}</p>

<table id="myTable" class="w3-table-all">
  <tr>
    {% for heading in headings %}
    <th onclick="w3.sortHTML('#myTable', '.item', 'td:nth-child({{ loop.index }})')" style="cursor:pointer">{{ heading }} &#x21D5;</th>
    {% endfor %}
  </tr>

  {% for row in data %}
  <tr class="item">
    {% for column in row %}
    <td>{{ column }}</td>
    {% endfor %}
  </tr>
  {% endfor %}
</table>

</body>
</html>